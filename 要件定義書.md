# 業務タスク管理 Web アプリ 要件定義書

## 1. 目的

本アプリは、日々の業務予定および実行済みタスクを簡潔に記録・振り返りできることを目的とする。入力負荷を最小化しつつ、YAML 形式での保存により、後続の分析・再利用・Git 管理等を容易にする。

---

## 2. 基本方針

- ブラウザ（Edge / Chrome）で動作する Web アプリ
- HTML / CSS / JavaScript + Web API を使用
- サーバーは使用せず、ファイル I/O はローカル YAML の読み書きのみ
- 日付選択を極力排除し、日常入力を高速化

---

## 3. データモデル

### 3.1 基本思想

- plan / result は分離しない
- タスクは「予定 → 実行 → 完了」という **状態遷移**で管理する
- 状態（status）はユーザー入力ではなく **アプリが自動管理**する

### 3.2 YAML スキーマ（確定）

```yaml
date: YYYY-MM-DD

tasks:
  - task: string
    detail: string
    status: todo | doing | done | carry

next:
  - task: string
    detail: string
```

- `tasks` : 当日の作業対象（予定と実績を統合）
- `next` : 翌日に実行予定のタスク

## 4. 振る舞い仕様

### 4.1 status の自動管理

- status はユーザー入力項目としない
- status は UI 操作に応じてアプリが自動遷移させる

#### status 遷移ルール（UI 起点）

| UI 操作       | 遷移前       | 遷移後 | 補足                            |
| ------------- | ------------ | ------ | ------------------------------- |
| tasks に生成  | －           | todo   | next からコピー、または新規追加 |
| detail を編集 | todo         | doing  | 文字数 0→1 以上で遷移           |
| 完了操作      | doing / todo | done   | 明示的な完了ボタン              |
| carry 操作    | todo / doing | carry  | 翌日へ持ち越し指定              |
| detail 再編集 | done         | done   | 状態は戻さない                  |

- status は自動で逆戻りしない
- carry は done よりも優先される

### 4.2 編集制限

- status が `done` であっても **全項目は編集可能**
- 履歴修正・振り返りを妨げない

### 4.3 日付遷移ルール

#### 翌日データ生成時

1. 前日の `next` をコピー
2. 新日の `tasks` に配置
3. status を `todo` に設定

```text
YYYY-MM-DD.next
      ↓
YYYY-MM-(DD+1).tasks
```

### 4.4 carry の扱い

- status を `carry` に設定した task は、保存時に `next` にコピーされる
- 元の task は当日の tasks に残す
  日付・カレンダー仕様

### 3.1 日付の扱い

- データは **日付キー（YYYY-MM-DD）単位** で管理する
- 「prev」は **前営業日の実行済みタスク** を意味する
- 営業日判定は以下を前提とする
  - 土日を非営業日とする
  - 祝日は将来拡張（初期は考慮しない）

### 3.2 カレンダー UI

- 月表示の表形式カレンダーを用意する
- 各日付セルをクリックすると、その日のタスク（prev / today）を表示
- 入力時は「本日」が自動的に選択された状態とする

---

## 4. データ構造（YAML）

### 4.1 基本構造

```yaml
2026-01-12:
  prev:
    - task: BI更新ツール変更
      status: done
      detail: BIツール完全分離。バッチファイル作成。
      scheduled: 2026-01-09
  today:
    - task: コイル棚卸し状況確認
      status: planned
      detail: 不明な重量エラー調査
      scheduled: 2026-01-12
```

### 4.2 タスク属性

| 属性名    | 必須 | 内容                     |
| --------- | ---- | ------------------------ |
| task      | ○    | タスク名                 |
| status    | ○    | `planned` / `done`       |
| detail    | 任意 | 補足説明                 |
| scheduled | ○    | 当初予定日（YYYY-MM-DD） |

※ タスク ID は付与しない（YAML の可読性・軽量性を優先）

---

## 5. タスク操作仕様

### 5.1 タスク追加

- 入力画面からタスクを追加すると、当日の `today` に登録
- `status` は `planned`
- `scheduled` は当日の日付を自動設定

### 5.2 タスク完了

- `today` のタスクを完了操作すると以下を実行
  - タスクを **翌営業日の `prev` にコピー**
  - `status` を `done` に変更
  - `detail` や `scheduled` はそのまま引き継ぐ

### 5.3 タスク編集

- 編集可能項目：
  - 完了操作（planned → done）のみ
- task 名・detail・scheduled は完了後は変更不可

---

## 6. UI / UX 要件

### 6.x デザイン指針

- 境界表現に **太い border は使用しない**
- border を使用する場合は 1px 以下相当で、存在感を極力抑える
- セクションの区切りは以下を優先する
  - 余白（padding / margin）
  - 明暗差（背景色のトーン差）
  - 影（box-shadow を最小限に使用）
- 近代的・業務向けの落ち着いた UI を前提とする
- 装飾目的の色や影は使用せず、情報構造の理解を補助するために用いる

### 6.0 全体レイアウト

- 画面左側に **タブ形式のサイドメニュー** を配置する
- サイドメニューは常時表示（PC）／折りたたみ可能（モバイル）
- メイン表示領域は、選択されたタブ内容に応じて切り替える

サイドメニュー：

- Today（本日の入力・確認）
- Calendar（日付別カレンダー表示）
- History（過去タスク一覧／振り返り）
- Settings（表示設定：ダークモード等）

### 6.1 表示構成

- 左：タブ形式サイドメニュー
- 右：メインコンテンツ領域

**Today タブ**

- カレンダー（当日が自動選択）
- 選択日のタスクリスト
  - prev（実行済み）
  - today（予定）
- タスク入力エリア

**Calendar タブ**

- 月表示の表形式カレンダー
- 各日付セルから当日のタスク詳細へ遷移可能

**History タブ**

- 日付順に prev / today を一覧表示
- 読み取り専用（編集不可）

**Settings タブ**

- ダークモード切替
- 表示設定（将来拡張）

- カレンダー表示（上部）
- 選択日のタスクリスト
  - prev（実行済み）
  - today（予定）
- タスク入力エリア

### 6.2 保存操作（Save）

- 画面右上に **Save ボタン** を配置する
- Save ボタン押下時に、現在の全データを YAML としてエクスポートする
- 保存操作は明示的に行う（自動保存は行わない）
- 保存未実行状態が分かるよう、必要に応じて視覚的インジケータを表示する（将来拡張）

### 6.3 ダークモード

- ライト / ダーク切り替え対応
- OS 設定に追従（`prefers-color-scheme`）

### 6.4 レスポンシブ対応

- PC：カレンダー＋タスクリスト並列表示
- モバイル：縦スクロール表示

### 6.5 タスクカード

**タスク表示単位**

- タスクは**1 件につき 1 カード**として表示する
- 当日タスク（tasks）および翌日タスク（next）は同一のカード UI コンポーネントを使用する

**レイアウト構成（概念）**

[ 左端カラーバー | 本文エリア ]

左端カラーバー：幅 約 10px
本文エリア：

- task（タイトル）
- detail（詳細・追記）
- 操作エリア（carry / done トグル）

**status と視覚表現**
| status | 表示 |
| ------------ | ------------------------- |
| todo | 左端カラーバーなし |
| carry/ doing | 左端カラーバー色 `#80F2C0` |
| done | 左端カラーバー色 `#E5F0E8` |

**実装上の補足**

- 左端カラーバーは border-left ではなく専用要素で実装する
- UI 状態は task.status を唯一の情報源とする
- カード UI はレスポンシブ対応とする

---

## 7. ファイル操作

### 7.1 読み込み

- YAML ファイルをユーザーが選択
- js-yaml でパースして内部データに反映

### 7.2 保存

- 現在のデータ全体を YAML としてエクスポート
- ファイル名例：
  - `tasks.yaml`
  - `tasks_2026-01.yaml`

---

## 8. 将来拡張（スコープ外）

- 祝日対応の営業日判定
- タスク検索・フィルタ
- Git 連携
- 集計・分析ビュー（件数、傾向など）

---

## 9. 非要件

- 認証・ユーザー管理は行わない
- 同時編集は想定しない

---

以上
